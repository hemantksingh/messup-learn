# Key Management Service (KMS)

AWS-managed encryption and decryption service

* Create and control encryption keys used to encrypt your data. Provides centralized control over the lifecycle and permissions of your keys
* Integrates with S3, EBS, RDS and other services to encrypt your data with the encryption keys you manage

## AWS KMS Keys

AWS KMS keys (KMS keys) are the primary resource in AWS KMS. You can use a KMS key to encrypt, decrypt, and re-encrypt data. It can also generate data keys that you can use outside of AWS KMS. Typically, you'll use symmetric KMS keys, but you can create and use asymmetric KMS keys for encryption or signing. AWS KMS key is a logical representation of an encryption key. It contains the key material used to encrypt and decrypt data. The key material for a KMS key can be

* generated by default, within AWS KMS. The key material cannot be extracted, exported or viewed. Also, you cannot delete this key material; you must delete the KMS key. The key material for the KMS key is generated within shared HSMs (Hardware Security Module) managed by AWS KMS.
* imported from your own key management infrastructure into a KMS key
* created in the **AWS CloudHSM** cluster associated with an [AWS KMS custom key store](https://docs.aws.amazon.com/kms/latest/developerguide/custom-key-store-overview.html). When you create an AWS KMS key in a custom key store, AWS KMS generates and stores non-extractable key material for the KMS key in an AWS CloudHSM cluster that you own and manage. When you use a KMS key in a custom key store, the cryptographic operations are performed in the HSMs in the cluster.

A **Hardware Security Module (HSM)** is a physical computing device containing one or more secure crypto-processor chips that safeguards and manages digital keys and performs encryption and decryption functions. The default AWS KMS key store is a shared service and protected by FIPS 140-2 validated cryptographic module but if your security requirement mandates a dedicated HSM, certified at FIPS 140-2 Level 3 with full control of underlying hardware you can opt for a custom key store.

* AWS KMS keys can be rotated automatically every year, provided that those keys were generated within AWS KMS HSMs.
* Automatic key rotation is not supported for imported keys, asymmetric keys or keys generated in an AWS CloudHSM cluster using the AWS KMS custom key store
* There are 3 ways to control permissions to KMS keys
  * Using the key policy (resource based policy attached to the KMS key) - the full scope of access to the KMS key is defined in a single document (the key policy)
  * Using IAM policies (policies attached to IAM identity) in combination with the key policy - manage all the permissions for your IAM identities in IAM
  * Using grants in combinations with the key policy - enables you to allow access to the KMS key in the key policy as well as allow users to delegate their access to others

## How do I protect my keys?

Different types of key material are allowed in KMS

* **Service managed keys** e.g. (S3 default encryption) are never seen by the customer and therefore they are not allowed to create a key policy on a service managed key

* **Customer managed key** where customers generate the key material and are responsible for managing the key and the key material

* Key deletion for customer managed key is instantaneous and can be destructive, therefore it is advisable to disable the CMK first before deleting it